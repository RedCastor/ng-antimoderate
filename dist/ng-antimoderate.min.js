!function(i){"use strict";i.module("ngAntimoderate",[]).directive("ngAntimoderate",["$timeout",function(e){return{restrict:"A",replace:!1,scope:{ngAntimoderate:"@",loadSrc:"@",loadTransitionDelay:"@",filter:"@",transition:"@",loadingClass:"@",loadedClass:"@",overflow:"@"},transclude:!1,link:function(n,t,o){function a(i){return parseFloat(i)*(/\ds$/.test(i)?1e3:1)}function r(i,e){return e=e||document.createElement("div"),i.parentNode.appendChild(e),e.appendChild(i)}function l(i){var e={image:new Image,src:i};return e.image.src=i,e}function s(i,e){if(e.transition&&e.overflow){if("DIV"!==i.parentElement.nodeName){var n=r(i);n.classList.add("antimoderate-overflow"),n.style.width="100%",n.style.height="100%"}i.parentElement.style.overflow="hidden"}return i}function d(i,e){return e.load_delay>0&&(i.style.opacity=0,i.style.transition="opacity "+e.load_delay+"ms"),i.classList.remove(e.loaded_class),i.classList.add(e.loading_class),i}function c(i,n){return n.load_delay>0&&(i.style.transition="opacity "+n.load_delay+"ms",i.style.opacity=1,e(function(){i.style.opacity=""},a(i.style.transitionDuration))),i}function f(i,e){return e.filter&&(i.style.filter=e.filter),i}function u(i,n){return n.transition&&(i.style.transition=n.transition),n.filter&&(i.style.filter="none "),e(function(){n.filter&&(i.style.filter=""),n.transition&&(n.overflow&&(i.parentElement.style.overflow=""),i.style.transition="")},a(i.style.transitionDuration)),i}function m(e,n,t){return e.src=n,i.isDefined(objectFitImages)&&i.isFunction(objectFitImages)&&objectFitImages("img.antimoderate"),e}var g=t[0],A={},y=[],_={};A.micro_src=n.ngAntimoderate||"",A.load_src=n.loadSrc||"data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",A.load_delay=parseInt(n.loadDelay)||300,A.filter=i.isDefined(n.filter)?n.filter:"blur(20px)",A.transition=i.isDefined(n.transition)?n.transition:"filter 300ms",A.loading_class=i.isDefined(n.loadingClass)?n.loadingClass:"loading",A.loaded_class=i.isDefined(n.loadedClass)?n.loadedClass:"loaded",A.overflow=!i.isDefined(n.overflow)||n.overflow;var p=function(i,n){var t=i[0];_.load=l(n.load_src),_.load.image.onload=function(){s(t,n),n.micro_src=n.micro_src.length?n.micro_src:n.load_src,_.micro=l(n.micro_src),_.micro.image.onload=function(){d(t,n);var a=e(function(){m(t,_.micro.src),_.load,c(t,n),f(t,n)},n.load_delay>0?n.load_delay/2:0);_.original=l(o.src),_.original.image.onload=function(){y.push(t.src),a.then(function(){i.removeClass(n.loading_class),i.addClass(n.loaded_class),e(function(){m(t,_.original.src),_.micro,_.original,u(t,n)},0)})},_.original.image.onerror=function(){u(t,n)}},_.micro.image.onerror=function(){c(t,n)},e(function(){m(t,_.load.src)},0)}};t.addClass("antimoderate"),-1===y.indexOf(g.src)&&p(t,A),n.$watch("ngAntimoderate",function(i,e){i!==e&&-1===y.indexOf(g.src)&&(A.micro_src=i,p(t,A))})}}}])}(window.angular);