!function(I){"use strict";var r=I.module("ngAntimoderate",[]);r.provider("$ngAntimoderate",[function(){var n={load:"data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",error:void 0};this.src=n,this.$get=[function(){var r=this.src;return{getSrc:function(){return r}}}],this.setSrc=function(r){this.src.load=r.load||n.load,this.src.error=r.error||n.error}}]),r.directive("ngAntimoderate",["$timeout","$window","$ngAntimoderate",function(S,C,E){return{restrict:"A",scope:{ngAntimoderate:"@",loadSrc:"@",loadDelay:"@",errSrc:"@",filter:"@",transition:"@",loadingClass:"@",loadedClass:"@",overflow:"@",onSuccess:"&",onError:"&"},transclude:!1,link:function(t,o,i){var r=E.getSrc(),e=o[0],a=e.style.display,s={},l=[],c={},n=r.load,d=r.error;function f(r){return parseFloat(r)*(/\ds$/.test(r)?1e3:1)}function u(r){var n={image:new Image,src:r};return n.image.src=r,n}function m(r,n){if(n.transition&&n.overflow){var o=(i=r,t=t||document.createElement("div"),i.parentNode.insertBefore(t,i.nextSibling),t.appendChild(i),t);o.classList.add("antimoderate-overflow"),o.style.width="100%",o.style.height="100%",o.style.overflow="hidden"}var i,t;return r}function g(r,n){return 0<n.load_delay&&(r.style.opacity=0,r.style.transition="opacity "+n.load_delay+"ms"),r.classList.remove(n.loaded_class),r.classList.add(n.loading_class),r}function y(r,n){return 0<n.load_delay&&(r.style.transition="opacity "+n.load_delay+"ms",r.style.opacity=1,S(function(){r.style.opacity=""},f(r.style.transitionDuration))),r}function A(r,n){return n.filter&&(r.style.filter=n.filter),r}function v(r,n){return n.transition&&(r.style.transition=n.transition),n.filter&&(r.style.filter="none "),S(function(){n.filter&&(r.style.filter=""),n.transition&&(n.overflow&&(r.parentElement.style.overflow=""),r.style.transition="")},f(r.style.transitionDuration)),r}function _(r,n){return r.classList.remove(n.loading_class),r.classList.add(n.loaded_class),r}function p(r,n,o){return r.src=n,I.isDefined(C.objectFitImages)&&I.isFunction(C.objectFitImages)&&objectFitImages("img.antimoderate"),r}function h(r,n,o){return r.srcset=n,p(r,n)}function w(r,n,o,i){o.original=u(r),o.original.image.onload=function(){l.push(e.src),i.then(function(){S(function(){p(e,o.original.src),o.micro,o.original,_(e,n),v(e,n),t.onSuccess()},0)})},o.original.image.onerror=function(){o.err=u(n.err_src),o.err.image.onload=function(){i.then(function(){S(function(){h(e,o.err.src),o.micro,o.original,o.err,_(e,n),v(e,n),t.onError()},0)})}}}s.micro_src=t.ngAntimoderate||"",s.load_src=t.loadSrc||n,s.err_src=t.errSrc||d||n,s.load_delay=parseInt(t.loadDelay)||300,s.filter=I.isDefined(t.filter)?t.filter:"blur(20px)",s.transition=I.isDefined(t.transition)?t.transition:"filter 300ms",s.loading_class=I.isDefined(t.loadingClass)?t.loadingClass:"loading",s.loaded_class=I.isDefined(t.loadedClass)?t.loadedClass:"loaded",s.overflow=!I.isDefined(t.overflow)||t.overflow;var D=function(r,n){var o=r[0];if(o.complete)return o.style.display=a,0===o.naturalWidth&&h(o,n.err_src),void l.push(o.src);c.load=u(n.load_src),c.load.image.onload=function(){m(o,n),n.micro_src=n.micro_src.length?n.micro_src:n.load_src,c.micro=u(n.micro_src),c.micro.image.onload=function(){g(o,n);var r=S(function(){p(o,c.micro.src),c.load,y(o,n),A(o,n)},0<n.load_delay?n.load_delay/2:0);w(i.src,n,c,r)},c.micro.image.onerror=function(){g(o,n);var r=S(function(){c.load,y(o,n),A(o,n)},0);w(i.src,n,c,r)},S(function(){p(o,c.load.src)},0)}};o.addClass("antimoderate"),e.style.display="none",e.src||(e.src=s.load_src),e.onload=function(){e.style.display=a,t.onSuccess()},e.onerror=function(){e.style.display=a,h(e,s.err_src),t.onError()},S(function(){-1===l.indexOf(e.src)&&D(o,s)},0,!1),t.$watch("ngAntimoderate",function(r,n){r!==n&&-1===l.indexOf(e.src)&&(s.micro_src=r,D(o,s))})}}}])}(window.angular);