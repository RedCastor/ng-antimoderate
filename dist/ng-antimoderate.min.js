!function(n){"use strict";n.module("ngAntimoderate",[]).directive("ngAntimoderate",["$timeout",function(i){return{restrict:"A",replace:!1,scope:{ngAntimoderate:"@",loadSrc:"@",loadTransitionDelay:"@",errSrc:"@",filter:"@",transition:"@",loadingClass:"@",loadedClass:"@",overflow:"@"},transclude:!1,link:function(t,e,r){function o(n){return parseFloat(n)*(/\ds$/.test(n)?1e3:1)}function a(n,i){return i=i||document.createElement("div"),n.parentNode.appendChild(i),i.appendChild(n),i}function l(n){var i={image:new Image,src:n};return i.image.src=n,i}function s(n){return null}function c(n,i){if(i.transition&&i.overflow){var t=a(n);t.classList.add("antimoderate-overflow"),t.style.width="100%",t.style.height="100%",t.style.overflow="hidden"}return n}function d(n,i){return i.load_delay>0&&(n.style.opacity=0,n.style.transition="opacity "+i.load_delay+"ms"),n.classList.remove(i.loaded_class),n.classList.add(i.loading_class),n}function f(n,t){return t.load_delay>0&&(n.style.transition="opacity "+t.load_delay+"ms",n.style.opacity=1,i(function(){n.style.opacity=""},o(n.style.transitionDuration))),n}function u(n,i){return i.filter&&(n.style.filter=i.filter),n}function m(n,t){return t.transition&&(n.style.transition=t.transition),t.filter&&(n.style.filter="none "),i(function(){t.filter&&(n.style.filter=""),t.transition&&(t.overflow&&(n.parentElement.style.overflow=""),n.style.transition="")},o(n.style.transitionDuration)),n}function g(n,i){return n.classList.remove(i.loading_class),n.classList.add(i.loaded_class),n}function A(i,t,e){return i.src=t,n.isDefined(objectFitImages)&&n.isFunction(objectFitImages)&&objectFitImages("img.antimoderate"),i}function y(n,t,e,r){e.original=l(n),e.original.image.onload=function(){p.push(_.src),r.then(function(){i(function(){A(_,e.original.src,t),s(e.micro),s(e.original),g(_,t),m(_,t)},0)})},e.original.image.onerror=function(){e.err=l(t.err_src),e.err.image.onload=function(){r.then(function(){i(function(){A(_,e.err.src,t),s(e.micro),s(e.original),s(e.err),g(_,t),m(_,t)},0)})}}}var _=e[0],v={},p=[],w={},h="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";v.micro_src=t.ngAntimoderate||"",v.load_src=t.loadSrc||h,v.err_src=t.errSrc||h,v.load_delay=parseInt(t.loadDelay)||300,v.filter=n.isDefined(t.filter)?t.filter:"blur(20px)",v.transition=n.isDefined(t.transition)?t.transition:"filter 300ms",v.loading_class=n.isDefined(t.loadingClass)?t.loadingClass:"loading",v.loaded_class=n.isDefined(t.loadedClass)?t.loadedClass:"loaded",v.overflow=!n.isDefined(t.overflow)||t.overflow;var C=function(n,t){var e=n[0];w.load=l(t.load_src),w.load.image.onload=function(){c(e,t),t.micro_src=t.micro_src.length?t.micro_src:t.load_src,w.micro=l(t.micro_src),w.micro.image.onload=function(){d(e,t);var n=i(function(){A(e,w.micro.src,t),s(w.load),f(e,t),u(e,t)},t.load_delay>0?t.load_delay/2:0);y(r.src,t,w,n)},w.micro.image.onerror=function(){d(e,t);var n=i(function(){s(w.load),f(e,t),u(e,t)},0);y(r.src,t,w,n)},i(function(){A(e,w.load.src,t)},0)}};e.addClass("antimoderate"),-1===p.indexOf(_.src)&&C(e,v),t.$watch("ngAntimoderate",function(n,i){n!==i&&-1===p.indexOf(_.src)&&(v.micro_src=n,C(e,v))})}}}])}(window.angular);