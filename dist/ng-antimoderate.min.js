!function(a){"use strict";a.module("ngAntimoderate",[]).directive("ngAntimoderate",[function(){return{restrict:"A",replace:!1,scope:{ngAntimoderate:"@",scale:"@",loadingClass:"@",loadedClass:"@"},transclude:!1,link:function(e,t,n){function r(a){for(c=0;c<a;++c)d.shg_table.push(g);++g}var l=t[0],s={},o=[];s.scale=e.scale||"2",s.loading_class=e.loadingClass||"loading",s.loaded_class=e.loadedClass||"loaded";for(var d={mul_table:[256,256,200,256,72,200,79,256,149,72,15,200,132,79,36,256,198,149,108,72,42,15,240,200,164,132,104,79,56,36,17,256,226,198,172,149,127,108,89,72,56,42,28,15,3,240,219,200,181,164,148,132,118,104,91,79,67,56,46,36,26,17,9,256,241,226,212,198,185,172,161,149,138,127,117,108,98,89,81,72,64,56,49,42,35,28,22,15,9,3,251,240,229,219,209,200,190,181,172,164,156,148,140,132,125,118,111,104,98,91,85,79,73,67,62,56,51,46,41,36,31,26,22,17,13,9,5,256,249,241,233,226,219,212,205,198,191,185,179,172,166,161,155,149,143,138,133,127,122,117,112,108,103,98,94,89,85,81,76,72,68,64,60,56,53,49,45,42,38,35,31,28,25,22,18,15,12,9,6,3,1,251,245,240,235,229,224,219,214,209,204,200,195,190,186,181,177,172,168,164,160,156,152,148,144,140,136,132,129,125,121,118,114,111,107,104,101,98,94,91,88,85,82,79,76,73,70,67,64,62,59,56,54,51,48,46,43,41,38,36,33,31,29,26,24,22,19,17,15,13,11,9,7,5,3],shg_table:[9,11,12,13,13,14,14],processImage:function(a,e,n){var r=document.createElement("canvas"),g=new Image;g.onload=function(){var e=a.width,c=a.height;r.style.width=e+"px",r.style.height=c+"px",r.width=e,r.height=c;var i=r.getContext("2d");i.clearRect(0,0,e,c),i.drawImage(g,0,0,e,c);var u=n||s.scale,f=Math.sqrt(e*c)/Math.sqrt(g.naturalWidth*g.naturalHeight)*u;if(!(isNaN(f)||f<1)){f|=0;var m,b,h,x,v,_,C,p,w,I,A,D,q,y,M,N,R,k,E,H,L,O=r.getContext("2d").getImageData(0,0,e,c),U=O.data,W=f+f+1,$=e-1,j=c-1,z=f+1,B=z*(z+1)/2,F={r:0,g:0,b:0,a:0,next:null},G=F;for(h=1;h<W;h++)G=G.next={r:0,g:0,b:0,a:0,next:null},h===z&&(L=G);G.next=F;var J=null,K=null;C=_=0;var P=d.mul_table[f],Q=d.shg_table[f];for(b=0;b<c;b++){for(y=M=N=p=w=I=0,A=z*(R=U[_]),D=z*(k=U[_+1]),q=z*(E=U[_+2]),p+=B*R,w+=B*k,I+=B*E,G=F,h=0;h<z;h++)G.r=R,G.g=k,G.b=E,G=G.next;for(h=1;h<z;h++)x=_+(($<h?$:h)<<2),p+=(G.r=R=U[x])*(H=z-h),w+=(G.g=k=U[x+1])*H,I+=(G.b=E=U[x+2])*H,y+=R,M+=k,N+=E,G=G.next;for(J=F,K=L,m=0;m<e;m++)U[_]=p*P>>Q,U[_+1]=w*P>>Q,U[_+2]=I*P>>Q,p-=A,w-=D,I-=q,A-=J.r,D-=J.g,q-=J.b,x=C+((x=m+f+1)<$?x:$)<<2,y+=J.r=U[x],M+=J.g=U[x+1],N+=J.b=U[x+2],p+=y,w+=M,I+=N,J=J.next,A+=R=K.r,D+=k=K.g,q+=E=K.b,y-=R,M-=k,N-=E,K=K.next,_+=4;C+=e}for(m=0;m<e;m++){for(M=N=y=w=I=p=0,_=m<<2,A=z*(R=U[_]),D=z*(k=U[_+1]),q=z*(E=U[_+2]),p+=B*R,w+=B*k,I+=B*E,G=F,h=0;h<z;h++)G.r=R,G.g=k,G.b=E,G=G.next;for(v=e,h=1;h<=f;h++)_=v+m<<2,p+=(G.r=R=U[_])*(H=z-h),w+=(G.g=k=U[_+1])*H,I+=(G.b=E=U[_+2])*H,y+=R,M+=k,N+=E,G=G.next,h<j&&(v+=e);for(_=m,J=F,K=L,b=0;b<c;b++)x=_<<2,U[x]=p*P>>Q,U[x+1]=w*P>>Q,U[x+2]=I*P>>Q,p-=A,w-=D,I-=q,A-=J.r,D-=J.g,q-=J.b,x=m+((x=b+z)<j?x:j)*e<<2,p+=y+=J.r=U[x],w+=M+=J.g=U[x+1],I+=N+=J.b=U[x+2],J=J.next,A+=R=K.r,D+=k=K.g,q+=E=K.b,y-=R,M-=k,N-=E,K=K.next,_+=e}var S=a.getAttribute("src");if(null!==S&&""!==S){t.removeClass(s.loaded_class),t.addClass(s.loading_class);var T=new Image;T.onload=function(){a.src=S,t.addClass(s.loaded_class),t.removeClass(s.loading_class),o.push(l.src)},T.src=S}r.getContext("2d").putImageData(O,0,0),a.src=r.toDataURL()}},g.src=e}},g=15,c=0;c<d.mul_table.length;)d.mul_table[c++]+=256;r(4),r(4),r(7),r(9),r(14),r(18),r(27),r(37),r(54),r(74),a.isDefined(l.src)&&(t.addClass("antimoderate"),e.$watch("ngAntimoderate",function(a){o.indexOf(l.src)===-1&&d.processImage(l,a,s.scale)}))}}}])}(window.angular);