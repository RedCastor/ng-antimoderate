{"version":3,"sources":["ng-antimoderate.js"],"names":["angular","module","directive","$timeout","restrict","replace","scope","ngAntimoderate","filter","transition","loadingClass","loadedClass","overflow","transclude","link","$scope","el","attrs","img","param","temp_loaded_src","micro_src","loading_class","loaded_class","toMS","s","parseFloat","test","processImage","img_el","idata","idata_img","Image","onload","orig_src","src","isDefined","removeClass","addClass","orig_img","push","objectFitImages","isFunction","style","parentElement","transitionDuration","indexOf","$watch","value","window"],"mappings":"CAAA,SAAUA;IACN;IAEAA,QAAQC,OAAO,sBAAsBC,UAAU,oBAAoB,YAAY,SAAUC;QACrF;YACIC,UAAU;YACVC,SAAS;YACTC;gBACIC,gBAAgB;gBAChBC,QAAQ;gBACRC,YAAY;gBACZC,cAAc;gBACdC,aAAa;gBACbC,UAAU;;YAEdC,YAAY;YACZC,MAAM,SAASC,QAAQC,IAAIC;gBAEvB,IAAIC,MAAMF,GAAG;gBACb,IAAIG;gBACJ,IAAIC;gBAEJD,MAAME,YAAYN,OAAOR,kBAAkB;gBAC3CY,MAAMX,SAASO,OAAOP,UAAU;gBAChCW,MAAMV,aAAaM,OAAON,cAAc;gBACxCU,MAAMG,gBAAgBP,OAAOL,gBAAgB;gBAC7CS,MAAMI,eAAeR,OAAOJ,eAAe;gBAC3CQ,MAAMP,WAAWG,OAAOH,YAAY;gBAOpC,SAASY,KAAKC;oBACV,OAAOC,WAAWD,MAAM,OAAOE,KAAKF,KAAI,MAAO;;gBAGnD,IAAIG,eAAe,SAAUC,QAAQC,OAAOX;oBAExC,IAAID,MAAMW,OAAO;oBACjB,IAAIE,YAAY,IAAIC;oBAEpBD,UAAUE,SAAS;wBACf,IAAIC,WAAWjB,MAAMkB;wBAErB,IAAInC,QAAQoC,UAAUF,aAAaA,aAAa,QAAQA,aAAa,IAAI;4BAErEL,OAAOQ,YAAYlB,MAAMI;4BACzBM,OAAOS,SAASnB,MAAMG;4BAEtB,IAAIiB,WAAW,IAAIP;4BACnBO,SAASN,SAAS;gCAEdJ,OAAOQ,YAAYlB,MAAMG;gCACzBO,OAAOS,SAASnB,MAAMI;gCAGtBpB,SAAS;oCACLe,IAAIiB,MAAMD;mCACX;gCAEHd,gBAAgBoB,KAAKtB,IAAIiB;gCAEzB,IAAInC,QAAQoC,UAAUK,oBAAoBzC,QAAQ0C,WAAWD,kBAAkB;oCAC3EA,gBAAgB;;gCAGpB,IAAItB,MAAMV,YAAY;oCAClBS,IAAIyB,MAAMlC,aAAaU,MAAMV;oCAE7BN,SAAS;wCACL,IAAIgB,MAAMP,UAAU;4CAChBM,IAAI0B,cAAcD,MAAM/B,WAAW;;uCAExCY,KAAKN,IAAIyB,MAAME;;gCAEtB,IAAI1B,MAAMX,QAAQ;oCACdU,IAAIyB,MAAMnC,SAAS;;;4BAK3B+B,SAASJ,MAAMD;;wBAInB/B,SAAS;4BACLe,IAAIiB,MAAMJ,UAAUI;2BACrB;wBAEH,IAAInC,QAAQoC,UAAUK,oBAAoBzC,QAAQ0C,WAAWD,kBAAkB;4BAC3EA,gBAAgB;;wBAGpB,IAAItB,MAAMV,YAAY;4BAClB,IAAIU,MAAMP,UAAU;gCAChBM,IAAI0B,cAAcD,MAAM/B,WAAW;;;wBAI3C,IAAIO,MAAMX,QAAQ;4BACdU,IAAIyB,MAAMnC,SAASW,MAAMX;;;oBAIjCuB,UAAUI,MAAML;;gBAGpB,IAAI9B,QAAQoC,UAAUlB,IAAIiB,MAAM;oBAC5BnB,GAAGsB,SAAS;oBAEZ,IAAIlB,gBAAgB0B,QAAQ5B,IAAIiB,UAAU,GAAG;wBACzCP,aAAaZ,IAAIG,MAAME,WAAWF;;oBAGtCJ,OAAOgC,OAAO,kBAAkB,SAASC;wBACrC,IAAI5B,gBAAgB0B,QAAQ5B,IAAIiB,UAAU,GAAG;4BACzCP,aAAaZ,IAAIgC,OAAO7B;;;;;;;GAQjD8B,OAAOjD","file":"ng-antimoderate.js","sourcesContent":["(function(angular){\n    'use strict';\n\n    angular.module('ngAntimoderate', []).directive('ngAntimoderate', [ '$timeout', function ($timeout) {\n        return {\n            restrict: \"A\",\n            replace: false,\n            scope: {\n                ngAntimoderate: \"@\",\n                filter: \"@\",\n                transition: \"@\",\n                loadingClass: \"@\",\n                loadedClass: \"@\",\n                overflow: \"@\"\n            },\n            transclude: false,\n            link: function($scope, el, attrs) {\n\n                var img = el[0];\n                var param = {};\n                var temp_loaded_src = [];\n\n                param.micro_src = $scope.ngAntimoderate || \"\";\n                param.filter = $scope.filter || \"\";\n                param.transition = $scope.transition || \"\";\n                param.loading_class = $scope.loadingClass || \"loading\";\n                param.loaded_class = $scope.loadedClass || \"loaded\";\n                param.overflow = $scope.overflow || true;\n\n                /**\n                 * Convert css timing to milisecond number\n                 * @param s\n                 * @returns {number}\n                 */\n                function toMS(s) {\n                    return parseFloat(s) * (/\\ds$/.test(s)? 1000 : 1);\n                }\n\n                var processImage = function (img_el, idata, param) {\n\n                    var img = img_el[0];\n                    var idata_img = new Image();\n\n                    idata_img.onload = function() {\n                        var orig_src = attrs.src;\n\n                        if (angular.isDefined(orig_src) && orig_src !== null && orig_src !== \"\") {\n\n                            img_el.removeClass(param.loaded_class);\n                            img_el.addClass(param.loading_class);\n\n                            var orig_img = new Image();\n                            orig_img.onload = function() {\n\n                                img_el.removeClass(param.loading_class);\n                                img_el.addClass(param.loaded_class);\n\n                                //Add Timeout for workaround on IE\n                                $timeout(function () {\n                                    img.src = orig_src;\n                                }, 0);\n\n                                temp_loaded_src.push(img.src);\n\n                                if (angular.isDefined(objectFitImages) && angular.isFunction(objectFitImages)) {\n                                    objectFitImages('img.antimoderate');\n                                }\n\n                                if (param.transition) {\n                                    img.style.transition = param.transition;\n\n                                    $timeout(function () {\n                                        if (param.overflow) {\n                                            img.parentElement.style.overflow = \"\";\n                                        }\n                                    }, toMS(img.style.transitionDuration) );\n                                }\n                                if (param.filter) {\n                                    img.style.filter = \"none \";\n                                }\n\n                            };\n\n                            orig_img.src = orig_src;\n                        }\n\n                        //Add Timeout for workaround on IE\n                        $timeout(function () {\n                            img.src = idata_img.src;\n                        }, 0);\n\n                        if (angular.isDefined(objectFitImages) && angular.isFunction(objectFitImages)) {\n                            objectFitImages('img.antimoderate');\n                        }\n\n                        if (param.transition) {\n                            if (param.overflow) {\n                                img.parentElement.style.overflow = \"hidden\";\n                            }\n                        }\n\n                        if (param.filter) {\n                            img.style.filter = param.filter;\n                        }\n                    };\n\n                    idata_img.src = idata;\n                };\n\n                if (angular.isDefined(img.src)) {\n                    el.addClass(\"antimoderate\");\n\n                    if (temp_loaded_src.indexOf(img.src) === -1) {\n                        processImage(el, param.micro_src, param);\n                    }\n\n                    $scope.$watch(\"ngAntimoderate\", function(value) {\n                        if (temp_loaded_src.indexOf(img.src) === -1) {\n                            processImage(el, value, param);\n                        }\n                    });\n                }\n            }\n        };\n    }]);\n\n})(window.angular);\n"],"sourceRoot":"dist"}